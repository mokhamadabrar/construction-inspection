<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Material Handling Checklist</title>
<style>
  :root{
    --brand:#6a1b9a;
    --row:#f7f9fc;
    --header:#0ea5e9;
    --border:#d1d5db;
    --ok:#16a34a;
    --warn:#ef4444;
    --muted:#6b7280;
  }
  *{box-sizing:border-box}
  body{
    font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial;
    margin:0; color:#111827; background:white;
  }

  /* page container */
  .page{
    max-width:1050px; /* A4 inner width roughly at 96dpi */
    margin:16px auto; padding:16px;
  }

  /* title block */
  .title{
    text-align:center; font-weight:800; letter-spacing:.3px;
    color:var(--brand); font-size:clamp(18px,4vw,28px);
    margin-bottom:8px;
  }
  .meta{
    display:grid; gap:8px 16px;
    grid-template-columns: repeat(6,1fr);
    font-size:13px; margin:8px 0 16px;
  }
  .meta .label{color:var(--muted)}
  .meta input{
    width:100%; padding:6px 8px; border:1px solid var(--border); border-radius:6px;
  }

  /* table base */
  .chk-table{
    width:100%; border-collapse:collapse; table-layout:fixed;
    border:1px solid var(--border); border-radius:10px; overflow:hidden;
  }
  .chk-table thead th{
    background:var(--header); color:white; padding:10px 8px; font-weight:700;
    font-size:13px; text-align:center; border:1px solid var(--header);
  }
  .section-head{
    background:#e2f3fb; color:#0b4a6f; font-weight:700; padding:8px; font-size:13px;
    border-top:1px solid var(--border); border-bottom:1px solid var(--border);
  }
  .sec-code{width:36px; text-align:center; font-weight:800; color:#0b4a6f}
  .col-no{width:34px; text-align:center}
  .col-ques{width:auto}
  .col-yn{width:48px; text-align:center}
  .col-remarks{width:22%}
  .chk-table td{
    padding:8px; border:1px solid var(--border); vertical-align:top; background:white;
  }
  .alt td{background:var(--row)}
  .ques{font-size:13px; line-height:1.35}

  /* touch friendly radios */
  .yn{
    display:flex; gap:6px; justify-content:center; align-items:center;
  }
  .yn input{ width:18px; height:18px; }
  .remarks{
    width:100%; min-height:36px; resize:vertical; font-size:12px;
    border:1px solid var(--border); border-radius:6px; padding:6px 8px;
  }

  /* score bar */
  .scores{
    display:grid; gap:10px; grid-template-columns: repeat(5,1fr);
    margin:14px 0 4px;
  }
  .score-card{
    border:1px solid var(--border); border-radius:10px; padding:10px;
    background:#fafafa;
  }
  .score-card h4{ margin:0 0 8px; font-size:13px; color:#0b4a6f }
  .score-val{
    font-weight:800; font-size:18px;
  }

  /* photo grid */
  .photos{
    display:grid; gap:12px; grid-template-columns: repeat(2,1fr);
    margin-top:14px;
  }
  @media (max-width:640px){
    .meta{ grid-template-columns: repeat(2,1fr); }
    .photos{ grid-template-columns: 1fr; }
    .col-remarks{ width:40% }
  }
  .photo-card{
    background:#4f81bd; border-radius:14px; padding:10px; color:white;
    position:relative; min-height:210px; display:flex; flex-direction:column; gap:8px;
  }
  .photo-stage{
    flex:1; border:2px dashed rgba(255,255,255,.7);
    border-radius:12px; display:grid; place-items:center; overflow:hidden;
    background:rgba(255,255,255,.06);
  }
  .photo-stage img{
    max-width:100%; max-height:100%; object-fit:contain; display:block;
  }
  .photo-actions{
    display:flex; gap:8px; align-items:center; flex-wrap:wrap;
  }
  .photo-actions input[type=file]{
    color:white; font-size:12px;
  }
  .photo-actions input[type=text]{
    flex:1; min-width:120px; border:none; border-radius:8px; padding:6px 8px; font-size:12px;
  }

  /* buttons */
  .toolbar{
    display:flex; gap:10px; justify-content:flex-end; margin-top:12px; flex-wrap:wrap;
  }
  .btn{
    border:none; border-radius:10px; padding:10px 14px; font-weight:700; cursor:pointer;
    background:#111827; color:white;
  }
  .btn.secondary{ background:#0ea5e9 }
  .badge{
    border-radius:999px; padding:3px 8px; font-size:11px; margin-left:8px; color:white;
  }
  .good{background:var(--ok)} .bad{background:var(--warn)}

  /* PRINT (A4, 1 page) */
  @page{ size:A4 portrait; margin:12mm }
  @media print{
    body{ background:white }
    .toolbar{ display:none !important }
    .page{ box-shadow:none; margin:0; padding:0 }
    .photos .photo-card{ min-height:150px }
    .meta input, .remarks, .photo-actions input[type=text]{ border:1px solid #ddd }
    .score-val{ font-size:16px }
    .chk-table td{ padding:6px }
    .title{ margin-top:0 }
  }
</style>
</head>
<body>
<div class="page">

  <div class="title">MATERIAL HANDLING CHECKLIST</div>

  <div class="meta">
    <div class="label">Inspector</div><input placeholder="Nama inspector" />
    <div class="label">Project</div><input placeholder="Kode/Nama" value="JKT09"/>
    <div class="label">Date</div><input type="date" />
    <div class="label">Location</div><input placeholder="Lokasi" />
  </div>

  <table class="chk-table" id="chkTable">
    <thead>
      <tr>
        <th class="sec-code">A–D</th>
        <th class="col-no">#</th>
        <th class="col-ques">METHOD OF WORK PLAN</th>
        <th class="col-yn">YES</th>
        <th class="col-yn">NO</th>
        <th class="col-yn">N/A</th>
        <th class="col-remarks">REMARKS</th>
      </tr>
    </thead>

    <!-- SECTION A -->
    <tbody data-section="A">
      <tr><td class="section-head" colspan="7">A. METHOD OF WORK PLAN</td></tr>
      <!-- row template: code / no / ques / yes / no / na / remarks -->
      <tr class="alt">
        <td class="sec-code">A</td><td class="col-no">1</td>
        <td class="ques">Rencana & Penempatan: MSRA sesuai lokasi, jadwal, spesifikasi area penyimpanan telah ditetapkan dan diverifikasi.</td>
        <td class="yn"><input type="radio" name="A1" value="yes"></td>
        <td class="yn"><input type="radio" name="A1" value="no"></td>
        <td class="yn"><input type="radio" name="A1" value="na"></td>
        <td><textarea class="remarks" placeholder="Catatan..."></textarea></td>
      </tr>
      <tr>
        <td class="sec-code">A</td><td class="col-no">2</td>
        <td class="ques">Logistik & Akses: Berat/dimensi material, jalur, kondisi jalan, staging area sudah di-assessment.</td>
        <td class="yn"><input type="radio" name="A2" value="yes"></td>
        <td class="yn"><input type="radio" name="A2" value="no"></td>
        <td class="yn"><input type="radio" name="A2" value="na"></td>
        <td><textarea class="remarks"></textarea></td>
      </tr>
      <tr class="alt">
        <td class="sec-code">A</td><td class="col-no">3</td>
        <td class="ques">Keselamatan & Segregasi: Jalur pejalan kaki/area aman & pemisahan fisik memadai; bahaya diidentifikasi.</td>
        <td class="yn"><input type="radio" name="A3" value="yes"></td>
        <td class="yn"><input type="radio" name="A3" value="no"></td>
        <td class="yn"><input type="radio" name="A3" value="na"></td>
        <td><textarea class="remarks"></textarea></td>
      </tr>
      <tr>
        <td class="sec-code">A</td><td class="col-no">4</td>
        <td class="ques">Manual handling: batas maksimum 18.14 kg/orang; >3 m & material panjang diangkat multi-person.</td>
        <td class="yn"><input type="radio" name="A4" value="yes"></td>
        <td class="yn"><input type="radio" name="A4" value="no"></td>
        <td class="yn"><input type="radio" name="A4" value="na"></td>
        <td><textarea class="remarks"></textarea></td>
      </tr>
    </tbody>

    <!-- SECTION B -->
    <tbody data-section="B">
      <tr><td class="section-head" colspan="7">B. PEOPLE / COMPETENCE / QUALIFICATION</td></tr>
      <tr class="alt">
        <td class="sec-code">B</td><td class="col-no">5</td>
        <td class="ques">GC menunjuk Move Manager berkompeten dan bertanggung jawab.</td>
        <td class="yn"><input type="radio" name="B5" value="yes"></td>
        <td class="yn"><input type="radio" name="B5" value="no"></td>
        <td class="yn"><input type="radio" name="B5" value="na"></td>
        <td><textarea class="remarks"></textarea></td>
      </tr>
      <tr>
        <td class="sec-code">B</td><td class="col-no">6</td>
        <td class="ques">Petugas inspeksi pemindahan ditunjuk & kompeten.</td>
        <td class="yn"><input type="radio" name="B6" value="yes"></td>
        <td class="yn"><input type="radio" name="B6" value="no"></td>
        <td class="yn"><input type="radio" name="B6" value="na"></td>
        <td><textarea class="remarks"></textarea></td>
      </tr>
      <tr class="alt">
        <td class="sec-code">B</td><td class="col-no">7</td>
        <td class="ques">Operator alat angkat memiliki kualifikasi/izin sesuai local requirement.</td>
        <td class="yn"><input type="radio" name="B7" value="yes"></td>
        <td class="yn"><input type="radio" name="B7" value="no"></td>
        <td class="yn"><input type="radio" name="B7" value="na"></td>
        <td><textarea class="remarks"></textarea></td>
      </tr>
    </tbody>

    <!-- SECTION C -->
    <tbody data-section="C">
      <tr><td class="section-head" colspan="7">C. TOOLS</td></tr>
      <tr class="alt">
        <td class="sec-code">C</td><td class="col-no">8</td>
        <td class="ques">Sertifikasi alat angkat sesuai requirement & valid.</td>
        <td class="yn"><input type="radio" name="C8" value="yes"></td>
        <td class="yn"><input type="radio" name="C8" value="no"></td>
        <td class="yn"><input type="radio" name="C8" value="na"></td>
        <td><textarea class="remarks"></textarea></td>
      </tr>
      <tr>
        <td class="sec-code">C</td><td class="col-no">9</td>
        <td class="ques">Alat angkat yang akan digunakan diperiksa sebelum didatangkan/dipakai.</td>
        <td class="yn"><input type="radio" name="C9" value="yes"></td>
        <td class="yn"><input type="radio" name="C9" value="no"></td>
        <td class="yn"><input type="radio" name="C9" value="na"></td>
        <td><textarea class="remarks"></textarea></td>
      </tr>
      <tr class="alt">
        <td class="sec-code">C</td><td class="col-no">10</td>
        <td class="ques">Alat bantu lainnya diinspeksi & dinyatakan layak.</td>
        <td class="yn"><input type="radio" name="C10" value="yes"></td>
        <td class="yn"><input type="radio" name="C10" value="no"></td>
        <td class="yn"><input type="radio" name="C10" value="na"></td>
        <td><textarea class="remarks"></textarea></td>
      </tr>
      <tr>
        <td class="sec-code">C</td><td class="col-no">11</td>
        <td class="ques">PPE sesuai MSDS & MSRA.</td>
        <td class="yn"><input type="radio" name="C11" value="yes"></td>
        <td class="yn"><input type="radio" name="C11" value="no"></td>
        <td class="yn"><input type="radio" name="C11" value="na"></td>
        <td><textarea class="remarks"></textarea></td>
      </tr>
    </tbody>

    <!-- SECTION D -->
    <tbody data-section="D">
      <tr><td class="section-head" colspan="7">D. ENVIRONMENT MANAGEMENT / CLEAN WORKPLACE</td></tr>
      <tr class="alt">
        <td class="sec-code">D</td><td class="col-no">12</td>
        <td class="ques">Rencana penanganan & pengangkutan sampah material tersedia.</td>
        <td class="yn"><input type="radio" name="D12" value="yes"></td>
        <td class="yn"><input type="radio" name="D12" value="no"></td>
        <td class="yn"><input type="radio" name="D12" value="na"></td>
        <td><textarea class="remarks"></textarea></td>
      </tr>
      <tr>
        <td class="sec-code">D</td><td class="col-no">13</td>
        <td class="ques">Kendaraan pengangkut sampah/material direncanakan.</td>
        <td class="yn"><input type="radio" name="D13" value="yes"></td>
        <td class="yn"><input type="radio" name="D13" value="no"></td>
        <td class="yn"><input type="radio" name="D13" value="na"></td>
        <td><textarea class="remarks"></textarea></td>
      </tr>
      <tr class="alt">
        <td class="sec-code">D</td><td class="col-no">14</td>
        <td class="ques">Program kebersihan area penyimpanan (housekeeping) berjalan.</td>
        <td class="yn"><input type="radio" name="D14" value="yes"></td>
        <td class="yn"><input type="radio" name="D14" value="no"></td>
        <td class="yn"><input type="radio" name="D14" value="na"></td>
        <td><textarea class="remarks"></textarea></td>
      </tr>
      <tr>
        <td class="sec-code">D</td><td class="col-no">15</td>
        <td class="ques">Program Room Free Dust & Floor Protection tersedia.</td>
        <td class="yn"><input type="radio" name="D15" value="yes"></td>
        <td class="yn"><input type="radio" name="D15" value="no"></td>
        <td class="yn"><input type="radio" name="D15" value="na"></td>
        <td><textarea class="remarks"></textarea></td>
      </tr>
    </tbody>
  </table>

  <!-- Scores -->
  <div class="scores">
    <div class="score-card"><h4>Score A</h4><div class="score-val" id="scoreA">0%</div></div>
    <div class="score-card"><h4>Score B</h4><div class="score-val" id="scoreB">0%</div></div>
    <div class="score-card"><h4>Score C</h4><div class="score-val" id="scoreC">0%</div></div>
    <div class="score-card"><h4>Score D</h4><div class="score-val" id="scoreD">0%</div></div>
    <div class="score-card">
      <h4>Total Score <span id="badge" class="badge">0/100</span></h4>
      <div class="score-val" id="totalScore">0%</div>
    </div>
  </div>

  <!-- Photos -->
  <div class="photos" id="photos">
    <!-- 4 slots like the sample -->
    <div class="photo-card" data-slot="1">
      <div class="photo-stage"><span>Tambahkan Foto</span></div>
      <div class="photo-actions">
        <input type="file" accept="image/*" />
        <input type="text" placeholder="Deskripsi foto…" />
      </div>
    </div>
    <div class="photo-card" data-slot="2">
      <div class="photo-stage"><span>Tambahkan Foto</span></div>
      <div class="photo-actions">
        <input type="file" accept="image/*" />
        <input type="text" placeholder="Deskripsi foto…" />
      </div>
    </div>
    <div class="photo-card" data-slot="3">
      <div class="photo-stage"><span>Tambahkan Foto</span></div>
      <div class="photo-actions">
        <input type="file" accept="image/*" />
        <input type="text" placeholder="Deskripsi foto…" />
      </div>
    </div>
    <div class="photo-card" data-slot="4">
      <div class="photo-stage"><span>Tambahkan Foto</span></div>
      <div class="photo-actions">
        <input type="file" accept="image/*" />
        <input type="text" placeholder="Deskripsi foto…" />
      </div>
    </div>
  </div>

  <div class="toolbar">
    <button class="btn secondary" id="resetBtn">Reset</button>
    <button class="btn" id="printBtn">Print PDF (A4)</button>
  </div>

</div>

<script>
  // ---- Helpers: scoring (Yes=1, No=0, N/A excluded) ----
  function sectionScore(sectionEl){
    const radios = sectionEl.querySelectorAll('input[type=radio]');
    const groups = new Map();
    radios.forEach(r=>{
      const nm = r.name;
      if(!groups.has(nm)) groups.set(nm, []);
      groups.get(nm).push(r);
    });
    let yes=0, applicable=0;
    groups.forEach(arr=>{
      const chosen = arr.find(x=>x.checked);
      if(!chosen) return; // unanswered -> exclude (treat like N/A)
      if(chosen.value === 'na') return; // NA doesn't count in denominator
      applicable++;
      if(chosen.value === 'yes') yes++;
    });
    if(applicable===0) return 0;
    return Math.round((yes/applicable)*100);
  }

  function updateScores(){
    const secA = document.querySelector('tbody[data-section=A]');
    const secB = document.querySelector('tbody[data-section=B]');
    const secC = document.querySelector('tbody[data-section=C]');
    const secD = document.querySelector('tbody[data-section=D]');
    const sA = sectionScore(secA);
    const sB = sectionScore(secB);
    const sC = sectionScore(secC);
    const sD = sectionScore(secD);
    // total across all answered non-NA items
    function totals(){
      const all = [secA,secB,secC,secD];
      let yes=0, applicable=0;
      all.forEach(sec=>{
        const byName = {};
        sec.querySelectorAll('input[type=radio]').forEach(r=>{
          byName[r.name] = byName[r.name] || [];
          byName[r.name].push(r);
        });
        Object.values(byName).forEach(arr=>{
          const chosen = arr.find(x=>x.checked);
          if(!chosen) return;
          if(chosen.value==='na') return;
          applicable++;
          if(chosen.value==='yes') yes++;
        });
      });
      if(applicable===0) return 0;
      return Math.round(100*yes/applicable);
    }
    const t = totals();

    document.getElementById('scoreA').textContent = sA + '%';
    document.getElementById('scoreB').textContent = sB + '%';
    document.getElementById('scoreC').textContent = sC + '%';
    document.getElementById('scoreD').textContent = sD + '%';
    document.getElementById('totalScore').textContent = t + '%';
    const badge = document.getElementById('badge');
    badge.textContent = `${t}/100`;
    badge.className = 'badge ' + (t>=80?'good':'bad');
  }

  // bind all radios
  document.querySelectorAll('#chkTable input[type=radio]').forEach(r=>{
    r.addEventListener('change', updateScores);
  });
  updateScores();

  // ---- Photos: proportional preview + caption ----
  document.querySelectorAll('.photo-card input[type=file]').forEach(inp=>{
    inp.addEventListener('change', e=>{
      const file = e.target.files[0];
      if(!file) return;
      const stage = e.target.closest('.photo-card').querySelector('.photo-stage');
      const img = document.createElement('img');
      img.alt = 'Photo';
      const reader = new FileReader();
      reader.onload = ev=>{
        stage.innerHTML='';
        img.src = ev.target.result;
        stage.appendChild(img);
      };
      reader.readAsDataURL(file);
    });
  });

  // ---- Reset ----
  document.getElementById('resetBtn').addEventListener('click', ()=>{
    document.querySelectorAll('#chkTable input[type=radio]').forEach(r=>r.checked=false);
    document.querySelectorAll('.remarks').forEach(t=>t.value='');
    document.querySelectorAll('.photo-card').forEach(card=>{
      card.querySelector('.photo-stage').innerHTML='<span>Tambahkan Foto</span>';
      card.querySelector('input[type=file]').value='';
      card.querySelector('input[type=text]').value='';
    });
    updateScores();
    window.scrollTo({top:0,behavior:'smooth'});
  });

  // ---- Print ----
  document.getElementById('printBtn').addEventListener('click', ()=>window.print());
</script>
</body>
</html>
