<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Material Handling Checklist — Final v3</title>
<style>
  :root{
    --brand:#6a1b9a; --row:#f7f9fc; --header:#0ea5e9; --border:#d1d5db;
    --ok:#16a34a; --bad:#ef4444; --muted:#6b7280;
  }
  *{box-sizing:border-box}
  body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Arial;margin:0;color:#111827;background:#fff}
  .page{max-width:1050px;margin:16px auto;padding:16px}
  .title{color:var(--brand);text-align:center;font-weight:800;font-size:clamp(18px,4vw,28px);margin:0 0 6px}

  /* LOGO */
  .logo-wrap{display:flex;justify-content:center;align-items:center;margin:6px 0 12px}
  .logo-wrap img{width:min(40vw,260px);height:auto;max-height:120px}
  .logo-caption{font-size:12px;color:#374151;text-align:center;margin-top:4px}

  .meta{display:grid;gap:8px 16px;grid-template-columns:repeat(6,1fr);font-size:13px;margin-bottom:8px}
  .meta .label{color:var(--muted)}
  .meta input{width:100%;padding:6px 8px;border:1px solid var(--border);border-radius:6px}

  /* table */
  .chk-table{width:100%;border-collapse:separate;border-spacing:0;overflow:hidden;border:1px solid var(--border);border-radius:10px;margin-top:6px}
  .chk-table thead th{background:var(--header);color:#fff;padding:10px 8px;font-weight:700;font-size:13px;text-align:center;border-right:1px solid var(--header)}
  .chk-table thead th:last-child{border-right:none}
  .section-head{background:#e2f3fb;color:#0b4a6f;font-weight:700;padding:8px;font-size:13px;border-top:1px solid var(--border);border-bottom:1px solid var(--border)}
  .col-no{width:70px;text-align:center;font-weight:800;color:#0b4a6f}
  .chk-table td{padding:8px;border-top:1px solid var(--border)}
  .row-alt{background:var(--row)}
  .ques{font-size:13px;line-height:1.35}
  .yn{display:flex;gap:10px;align-items:center}
  .yn label{display:flex;gap:6px;align-items:center;font-size:13px}
  .yn input{width:18px;height:18px}

  /* remarks + counter */
  .remarks{width:100%;min-height:40px;border:1px solid var(--border);border-radius:8px;padding:6px 8px;font-size:12px;resize:vertical}
  .subrow td{border-top:none;padding-top:4px;padding-bottom:8px}
  .remarks-cell{padding:6px 8px 6px}
  .remarks-wrap{display:flex;flex-direction:column;gap:4px}
  .counter{font-size:11px;color:#6b7280}
  .counter.limit{color:var(--bad);font-weight:700}

  /* scores */
  .scores{display:grid;gap:10px;grid-template-columns:repeat(5,1fr);margin:12px 0 6px}
  .score-card{border:1px solid var(--border);border-radius:10px;background:#fafafa;padding:10px}
  .score-card h4{margin:0 0 8px;font-size:13px;color:#0b4a6f}
  .score-val{font-weight:800;font-size:18px}
  .badge{border-radius:999px;padding:3px 8px;font-size:11px;margin-left:8px;color:#fff;background:#111827}
  .good{background:var(--ok)!important} .bad{background:var(--bad)!important}

  /* photos */
  .photos{display:grid;gap:12px;grid-template-columns:repeat(2,1fr);margin-top:10px}
  .photo-card{background:#4f81bd;border-radius:14px;padding:10px;color:#fff;min-height:210px;display:flex;flex-direction:column;gap:8px;break-inside:avoid}
  .photo-stage{flex:1;border:2px dashed rgba(255,255,255,.7);border-radius:12px;display:grid;place-items:center;overflow:hidden;background:rgba(255,255,255,.06)}
  .photo-stage img{max-width:100%;max-height:100%;object-fit:contain;display:block}
  .photo-actions{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
  .photo-actions input[type=file]{color:#fff;font-size:12px}
  .photo-desc{flex:1;min-width:120px;border:none;border-radius:8px;padding:6px 8px;font-size:12px}
  .photo-desc-print{display:none;margin-top:6px;font-size:12px;line-height:1.3;background:rgba(255,255,255,.12);padding:4px 6px;border-radius:6px}

  /* responsive */
  @media (max-width:800px){ .meta{grid-template-columns:repeat(2,1fr)} }
  @media (max-width:640px){ .photos{grid-template-columns:1fr} .col-no{width:64px} }

  /* print: A4, remarks printed as text; photos on dedicated page */
  @page{size:A4 portrait;margin:12mm}
  @media print{
    .toolbar{display:none!important}
    .page{margin:0;padding:0}
    .score-val{font-size:16px}
    .chk-table td{padding:6px}
    .logo-caption{display:none}
    /* remarks textarea as plain text */
    textarea.remarks{
      border:none !important; outline:none !important; resize:none !important;
      overflow:visible !important; white-space:pre-wrap !important;
      font-size:12px !important; background:transparent !important;
      height:auto !important; min-height:unset !important;
      -webkit-appearance:none; appearance:none;
    }
    .counter{display:none}

    /* ---- Photos page only (compact 1 page) ---- */
    .photos{
      page-break-before: always;   /* start new page for photos */
      page-break-after: always;    /* keep it as a dedicated page */
      grid-template-columns: 1fr 1fr;
      gap: 6mm;
      margin-top: 0;
    }
    .photo-card{
      background:#fff; color:#111;
      border:1px solid #ddd; padding:5mm; border-radius:6px;
      min-height:120mm;                 /* 2 rows per A4 (approx) */
      break-inside: avoid;
      page-break-inside: avoid;
    }
    .photo-stage{
      border:1px solid #ccc; background:#fff; border-radius:4px;
    }
    .photo-actions{display:none}        /* hide inputs on print */
    .photo-desc-print{
      display:block;                    /* show clean caption */
      font-size:11px; color:#111; background:transparent; padding:0; margin-top:3mm
    }
  }
</style>
</head>
<body>
<div class="page">
  <div class="title">MATERIAL HANDLING CHECKLIST</div>

  <!-- LOGO -->
  <div class="logo-wrap" aria-label="Logo PT Jaya Obayashi">
    <div>
      <img src="https://mokhamadabrar.github.io/construction-inspection/Logo-JO.png" alt="PT Jaya Obayashi" />
      <div class="logo-caption">PT Jaya Obayashi</div>
    </div>
  </div>

  <div class="meta">
    <div class="label">Inspector</div><input placeholder="Nama inspector"/>
    <div class="label">Project</div><input value="JKT09" placeholder="Kode/Nama"/>
    <div class="label">Date</div><input type="date"/>
    <div class="label">Location</div><input placeholder="Lokasi"/>
  </div>

  <table class="chk-table" id="chkTable">
    <thead>
      <tr>
        <th class="col-no">No.</th>
        <th>Pertanyaan</th>
        <th>YES</th>
        <th>NO</th>
        <th>N/A</th>
      </tr>
    </thead>

    <!-- ===== SECTION A ===== -->
    <tbody data-section="A">
      <tr><td class="section-head" colspan="5">A. METHOD OF WORK PLAN</td></tr>

      <tr class="row-alt">
        <td class="col-no">A1</td>
        <td colspan="4"><div class="ques">Rencana & Penempatan: MSRA sesuai lokasi, jadwal, dan spesifikasi area penyimpanan telah ditetapkan dan diverifikasi.</div></td>
      </tr>
      <tr class="subrow row-alt">
        <td></td>
        <td>
          <div class="yn">
            <label><input type="radio" name="A1" value="yes"> Ya</label>
            <label><input type="radio" name="A1" value="no"> Tidak</label>
            <label><input type="radio" name="A1" value="na"> N/A</label>
          </div>
        </td>
        <td colspan="3" class="remarks-cell">
          <div class="remarks-wrap">
            <textarea class="remarks" maxlength="70" placeholder="Remarks (maks 70 karakter)…"></textarea>
            <div class="counter">0/70</div>
          </div>
        </td>
      </tr>

      <tr>
        <td class="col-no">A2</td>
        <td colspan="4"><div class="ques">Logistik & Akses: Berat/dimensi material, metode movement & alat angkat, rute transporter, kondisi jalan, dan staging area telah di-assessment.</div></td>
      </tr>
      <tr class="subrow">
        <td></td>
        <td><div class="yn">
          <label><input type="radio" name="A2" value="yes"> Ya</label>
          <label><input type="radio" name="A2" value="no"> Tidak</label>
          <label><input type="radio" name="A2" value="na"> N/A</label>
        </div></td>
        <td colspan="3" class="remarks-cell">
          <div class="remarks-wrap">
            <textarea class="remarks" maxlength="70"></textarea>
            <div class="counter">0/70</div>
          </div>
        </td>
      </tr>

      <tr class="row-alt">
        <td class="col-no">A3</td>
        <td colspan="4"><div class="ques">Keselamatan & Segregasi: Jalur pejalan kaki terpisah dari jalur material; penghalang fisik tersedia; bahaya diidentifikasi.</div></td>
      </tr>
      <tr class="subrow row-alt">
        <td></td>
        <td><div class="yn">
          <label><input type="radio" name="A3" value="yes"> Ya</label>
          <label><input type="radio" name="A3" value="no"> Tidak</label>
          <label><input type="radio" name="A3" value="na"> N/A</label>
        </div></td>
        <td colspan="3" class="remarks-cell">
          <div class="remarks-wrap">
            <textarea class="remarks" maxlength="70"></textarea>
            <div class="counter">0/70</div>
          </div>
        </td>
      </tr>

      <tr>
        <td class="col-no">A4</td>
        <td colspan="4"><div class="ques">Manual handling: batas maksimum per orang 18.14 kg; material panjang atau &gt;3 m diangkat lebih dari satu orang.</div></td>
      </tr>
      <tr class="subrow">
        <td></td>
        <td><div class="yn">
          <label><input type="radio" name="A4" value="yes"> Ya</label>
          <label><input type="radio" name="A4" value="no"> Tidak</label>
          <label><input type="radio" name="A4" value="na"> N/A</label>
        </div></td>
        <td colspan="3" class="remarks-cell">
          <div class="remarks-wrap">
            <textarea class="remarks" maxlength="70"></textarea>
            <div class="counter">0/70</div>
          </div>
        </td>
      </tr>
    </tbody>

    <!-- ===== SECTION B ===== -->
    <tbody data-section="B">
      <tr><td class="section-head" colspan="5">B. PEOPLE / COMPETENCE / QUALIFICATION</td></tr>

      <tr class="row-alt"><td class="col-no">B5</td><td colspan="4" class="ques">GC menunjuk Move Manager yang kompeten & bertanggung jawab.</td></tr>
      <tr class="subrow row-alt"><td></td><td><div class="yn">
        <label><input type="radio" name="B5" value="yes"> Ya</label>
        <label><input type="radio" name="B5" value="no"> Tidak</label>
        <label><input type="radio" name="B5" value="na"> N/A</label>
      </div></td><td colspan="3" class="remarks-cell">
        <div class="remarks-wrap">
          <textarea class="remarks" maxlength="70"></textarea>
          <div class="counter">0/70</div>
        </div>
      </td></tr>

      <tr><td class="col-no">B6</td><td colspan="4" class="ques">Petugas inspeksi pemindahan ditunjuk & kompeten.</td></tr>
      <tr class="subrow"><td></td><td><div class="yn">
        <label><input type="radio" name="B6" value="yes"> Ya</label>
        <label><input type="radio" name="B6" value="no"> Tidak</label>
        <label><input type="radio" name="B6" value="na"> N/A</label>
      </div></td><td colspan="3" class="remarks-cell">
        <div class="remarks-wrap">
          <textarea class="remarks" maxlength="70"></textarea>
          <div class="counter">0/70</div>
        </div>
      </td></tr>

      <tr class="row-alt"><td class="col-no">B7</td><td colspan="4" class="ques">Operator alat angkat memiliki kualifikasi/izin sesuai persyaratan lokal & masih berlaku.</td></tr>
      <tr class="subrow row-alt"><td></td><td><div class="yn">
        <label><input type="radio" name="B7" value="yes"> Ya</label>
        <label><input type="radio" name="B7" value="no"> Tidak</label>
        <label><input type="radio" name="B7" value="na"> N/A</label>
      </div></td><td colspan="3" class="remarks-cell">
        <div class="remarks-wrap">
          <textarea class="remarks" maxlength="70"></textarea>
          <div class="counter">0/70</div>
        </div>
      </td></tr>
    </tbody>

    <!-- ===== SECTION C ===== -->
    <tbody data-section="C">
      <tr><td class="section-head" colspan="5">C. TOOLS</td></tr>

      <tr class="row-alt"><td class="col-no">C8</td><td colspan="4" class="ques">Sertifikasi alat angkat sesuai requirement & valid.</td></tr>
      <tr class="subrow row-alt"><td></td><td><div class="yn">
        <label><input type="radio" name="C8" value="yes"> Ya</label>
        <label><input type="radio" name="C8" value="no"> Tidak</label>
        <label><input type="radio" name="C8" value="na"> N/A</label>
      </div></td><td colspan="3" class="remarks-cell">
        <div class="remarks-wrap">
          <textarea class="remarks" maxlength="70"></textarea>
          <div class="counter">0/70</div>
        </div>
      </td></tr>

      <tr><td class="col-no">C9</td><td colspan="4" class="ques">Alat angkat yang digunakan diperiksa sebelum didatangkan/dipakai.</td></tr>
      <tr class="subrow"><td></td><td><div class="yn">
        <label><input type="radio" name="C9" value="yes"> Ya</label>
        <label><input type="radio" name="C9" value="no"> Tidak</label>
        <label><input type="radio" name="C9" value="na"> N/A</label>
      </div></td><td colspan="3" class="remarks-cell">
        <div class="remarks-wrap">
          <textarea class="remarks" maxlength="70"></textarea>
          <div class="counter">0/70</div>
        </div>
      </td></tr>

      <tr class="row-alt"><td class="col-no">C10</td><td colspan="4" class="ques">Alat bantu lainnya diinspeksi & dinyatakan layak.</td></tr>
      <tr class="subrow row-alt"><td></td><td><div class="yn">
        <label><input type="radio" name="C10" value="yes"> Ya</label>
        <label><input type="radio" name="C10" value="no"> Tidak</label>
        <label><input type="radio" name="C10" value="na"> N/A</label>
      </div></td><td colspan="3" class="remarks-cell">
        <div class="remarks-wrap">
          <textarea class="remarks" maxlength="70"></textarea>
          <div class="counter">0/70</div>
        </div>
      </td></tr>

      <tr><td class="col-no">C11</td><td colspan="4" class="ques">PPE sesuai MSDS & MSRA.</td></tr>
      <tr class="subrow"><td></td><td><div class="yn">
        <label><input type="radio" name="C11" value="yes"> Ya</label>
        <label><input type="radio" name="C11" value="no"> Tidak</label>
        <label><input type="radio" name="C11" value="na"> N/A</label>
      </div></td><td colspan="3" class="remarks-cell">
        <div class="remarks-wrap">
          <textarea class="remarks" maxlength="70"></textarea>
          <div class="counter">0/70</div>
        </div>
      </td></tr>
    </tbody>

    <!-- ===== SECTION D ===== -->
    <tbody data-section="D">
      <tr><td class="section-head" colspan="5">D. ENVIRONMENT MANAGEMENT / CLEAN WORKPLACE</td></tr>

      <tr class="row-alt"><td class="col-no">D12</td><td colspan="4" class="ques">Rencana penanganan & pengangkutan sampah material tersedia.</td></tr>
      <tr class="subrow row-alt"><td></td><td><div class="yn">
        <label><input type="radio" name="D12" value="yes"> Ya</label>
        <label><input type="radio" name="D12" value="no"> Tidak</label>
        <label><input type="radio" name="D12" value="na"> N/A</label>
      </div></td><td colspan="3" class="remarks-cell">
        <div class="remarks-wrap">
          <textarea class="remarks" maxlength="70"></textarea>
          <div class="counter">0/70</div>
        </div>
      </td></tr>

      <tr><td class="col-no">D13</td><td colspan="4" class="ques">Kendaraan pengangkut sampah/material direncanakan.</td></tr>
      <tr class="subrow"><td></td><td><div class="yn">
        <label><input type="radio" name="D13" value="yes"> Ya</label>
        <label><input type="radio" name="D13" value="no"> Tidak</label>
        <label><input type="radio" name="D13" value="na"> N/A</label>
      </div></td><td colspan="3" class="remarks-cell">
        <div class="remarks-wrap">
          <textarea class="remarks" maxlength="70"></textarea>
          <div class="counter">0/70</div>
        </div>
      </td></tr>

      <tr class="row-alt"><td class="col-no">D14</td><td colspan="4" class="ques">Program kebersihan area penyimpanan (housekeeping) berjalan.</td></tr>
      <tr class="subrow row-alt"><td></td><td><div class="yn">
        <label><input type="radio" name="D14" value="yes"> Ya</label>
        <label><input type="radio" name="D14" value="no"> Tidak</label>
        <label><input type="radio" name="D14" value="na"> N/A</label>
      </div></td><td colspan="3" class="remarks-cell">
        <div class="remarks-wrap">
          <textarea class="remarks" maxlength="70"></textarea>
          <div class="counter">0/70</div>
        </div>
      </td></tr>

      <tr><td class="col-no">D15</td><td colspan="4" class="ques">Program Room Free Dust & Floor Protection tersedia.</td></tr>
      <tr class="subrow"><td></td><td><div class="yn">
        <label><input type="radio" name="D15" value="yes"> Ya</label>
        <label><input type="radio" name="D15" value="no"> Tidak</label>
        <label><input type="radio" name="D15" value="na"> N/A</label>
      </div></td><td colspan="3" class="remarks-cell">
        <div class="remarks-wrap">
          <textarea class="remarks" maxlength="70"></textarea>
          <div class="counter">0/70</div>
        </div>
      </td></tr>
    </tbody>
  </table>

  <!-- Scores -->
  <div class="scores">
    <div class="score-card"><h4>Score A</h4><div class="score-val" id="scoreA">0%</div></div>
    <div class="score-card"><h4>Score B</h4><div class="score-val" id="scoreB">0%</div></div>
    <div class="score-card"><h4>Score C</h4><div class="score-val" id="scoreC">0%</div></div>
    <div class="score-card"><h4>Score D</h4><div class="score-val" id="scoreD">0%</div></div>
    <div class="score-card"><h4>Total Score <span id="badge" class="badge">0/100</span></h4><div class="score-val" id="totalScore">0%</div></div>
  </div>

  <!-- Photos (will print on a dedicated page) -->
  <div class="photos" id="photos">
    <div class="photo-card" data-slot="1">
      <div class="photo-stage"><span>Tambahkan Foto</span></div>
      <div class="photo-actions">
        <input type="file" accept="image/*" />
        <input type="text" class="photo-desc" maxlength="58" placeholder="Deskripsi foto (maks 58)…" />
      </div>
      <div class="photo-desc-print"></div>
    </div>
    <div class="photo-card" data-slot="2">
      <div class="photo-stage"><span>Tambahkan Foto</span></div>
      <div class="photo-actions">
        <input type="file" accept="image/*" />
        <input type="text" class="photo-desc" maxlength="58" placeholder="Deskripsi foto (maks 58)…" />
      </div>
      <div class="photo-desc-print"></div>
    </div>
    <div class="photo-card" data-slot="3">
      <div class="photo-stage"><span>Tambahkan Foto</span></div>
      <div class="photo-actions">
        <input type="file" accept="image/*" />
        <input type="text" class="photo-desc" maxlength="58" placeholder="Deskripsi foto (maks 58)…" />
      </div>
      <div class="photo-desc-print"></div>
    </div>
    <div class="photo-card" data-slot="4">
      <div class="photo-stage"><span>Tambahkan Foto</span></div>
      <div class="photo-actions">
        <input type="file" accept="image/*" />
        <input type="text" class="photo-desc" maxlength="58" placeholder="Deskripsi foto (maks 58)…" />
      </div>
      <div class="photo-desc-print"></div>
    </div>
  </div>

  <div class="toolbar" style="display:flex;gap:10px;justify-content:flex-end;margin-top:12px;flex-wrap:wrap">
    <button class="btn" id="printBtn" style="border:none;border-radius:10px;padding:10px 14px;font-weight:700;background:#111827;color:#fff">Print PDF (A4)</button>
    <button class="btn" id="resetBtn" style="border:none;border-radius:10px;padding:10px 14px;font-weight:700;background:#0ea5e9;color:#fff">Reset</button>
  </div>
</div>

<script>
  // ---- scoring (Yes=1, No=0, N/A & kosong: exclude) ----
  function scoreSection(sec){
    const names = new Set();
    sec.querySelectorAll('input[type=radio]').forEach(r=>names.add(r.name));
    let yes=0, denom=0;
    names.forEach(n=>{
      const chosen = sec.querySelector(`input[name="${n}"]:checked`);
      if(!chosen || chosen.value==='na') return;
      denom++; if(chosen.value==='yes') yes++;
    });
    return denom? Math.round(100*yes/denom):0;
  }
  function refreshScores(){
    const A = document.querySelector('tbody[data-section="A"]');
    const B = document.querySelector('tbody[data-section="B"]');
    const C = document.querySelector('tbody[data-section="C"]');
    const D = document.querySelector('tbody[data-section="D"]');
    const sA = scoreSection(A), sB = scoreSection(B), sC = scoreSection(C), sD = scoreSection(D);

    let yes=0, denom=0;
    [A,B,C,D].forEach(sec=>{
      const names = new Set();
      sec.querySelectorAll('input[type=radio]').forEach(r=>names.add(r.name));
      names.forEach(n=>{
        const chosen = sec.querySelector(`input[name="${n}"]:checked`);
        if(!chosen || chosen.value==='na') return;
        denom++; if(chosen.value==='yes') yes++;
      });
    });
    const total = denom? Math.round(100*yes/denom):0;

    document.getElementById('scoreA').textContent = sA + '%';
    document.getElementById('scoreB').textContent = sB + '%';
    document.getElementById('scoreC').textContent = sC + '%';
    document.getElementById('scoreD').textContent = sD + '%';
    document.getElementById('totalScore').textContent = total + '%';
    const badge = document.getElementById('badge');
    badge.textContent = `${total}/100`;
    badge.classList.remove('good','bad');
    badge.classList.add(total>=80 ? 'good' : 'bad');
  }
  document.querySelectorAll('#chkTable input[type=radio]').forEach(r=>r.addEventListener('change', refreshScores));
  refreshScores();

  // ---- Helpers: generic max enforcement with pop-up alert ----
  function enforceMaxWithAlert(el, MAX, fieldName){
    if(el.value.length > MAX){
      el.value = el.value.slice(0, MAX);
      // Alarm pop-up
      alert(`Maksimal ${MAX} karakter untuk ${fieldName}. Teks telah dipotong agar sesuai ketentuan.`);
      return true;
    }
    return false;
  }

  // ---- Remarks (70 chars) + counter + pop-up alert ----
  const MAX_REMARKS = 70;
  function updateCounter(area){
    const wrap = area.closest('.remarks-wrap');
    const counter = wrap.querySelector('.counter');
    const len = area.value.length;
    counter.textContent = `${len}/${MAX_REMARKS}`;
    counter.classList.toggle('limit', len >= MAX_REMARKS);
  }
  document.querySelectorAll('textarea.remarks').forEach(area=>{
    area.setAttribute('maxlength', String(MAX_REMARKS));
    updateCounter(area);
    area.addEventListener('input', e=>{
      enforceMaxWithAlert(e.target, MAX_REMARKS, 'Remarks');
      updateCounter(e.target);
    });
    area.addEventListener('paste', e=>{
      setTimeout(()=>{
        enforceMaxWithAlert(e.target, MAX_REMARKS, 'Remarks');
        updateCounter(e.target);
      },0);
    });
  });

  // ---- Photos: preview + description (58 chars) + printable caption ----
  const MAX_DESC = 58;
  document.querySelectorAll('.photo-card input[type=file]').forEach(inp=>{
    inp.addEventListener('change', e=>{
      const file = e.target.files[0]; if(!file) return;
      const stage = e.target.closest('.photo-card').querySelector('.photo-stage');
      const img = document.createElement('img');
      const rd = new FileReader();
      rd.onload = ev=>{ stage.innerHTML=''; img.src = ev.target.result; stage.appendChild(img); };
      rd.readAsDataURL(file);
    });
  });

  document.querySelectorAll('.photo-card .photo-desc').forEach(desc=>{
    const printBox = desc.closest('.photo-card').querySelector('.photo-desc-print');
    const sync = ()=>{
      enforceMaxWithAlert(desc, MAX_DESC, 'Deskripsi Foto');
      printBox.textContent = desc.value ? desc.value : '';
    };
    // init
    desc.setAttribute('maxlength', String(MAX_DESC));
    sync();
    // listeners
    desc.addEventListener('input', sync);
    desc.addEventListener('paste', ()=>setTimeout(sync,0));
  });

  // ---- print & reset ----
  document.getElementById('printBtn').addEventListener('click', ()=>window.print());
  document.getElementById('resetBtn').addEventListener('click', ()=>{
    document.querySelectorAll('#chkTable input[type=radio]').forEach(r=>r.checked=false);
    document.querySelectorAll('.remarks').forEach(t=>{ t.value=''; updateCounter(t); });
    document.querySelectorAll('.photo-card').forEach(card=>{
      card.querySelector('.photo-stage').innerHTML='<span>Tambahkan Foto</span>';
      const f = card.querySelector('input[type=file]'); if(f) f.value='';
      const d = card.querySelector('.photo-desc'); if(d){ d.value=''; }
      const pb = card.querySelector('.photo-desc-print'); if(pb){ pb.textContent=''; }
    });
    refreshScores(); window.scrollTo({top:0,behavior:'smooth'});
  });
</script>
</body>
</html>
